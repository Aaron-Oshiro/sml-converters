{
  "$id": "https://www.atscale.com/ml/rowSecurity.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "RowSecurity",
  "type": "object",
  "required": ["unique_name", "object_type", "label", "dataset", "scope", "ids_column", "id_type", "filter_key_column"],
  "properties": {
    "unique_name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 63
    },
    "object_type": {
      "const": "row_security"
    },
    "label": {
      "type": "string",
      "minLength": 1,
      "maxLength": 128
    },
    "description": {
      "type": "string"
    },
    "dataset": {
      "type": "string",
      "minLength": 1,
      "maxLength": 128
    },
    "scope": {
      "type": "string",
      "enum": ["fact", "related", "all"],
      "errorMessage": "must have a value: 'fact', 'related' or 'all'"
    },
    "ids_column": {
      "type": "string",
      "minLength": 1
    },
    "id_type": {
      "type": "string",
      "enum": ["user", "group"],
      "errorMessage": "must have a value: 'user' or 'group'"
    },
    "filter_key_column": {
      "type": "string",
      "minLength": 1
    },
    "use_filter_key": {
      "type": "boolean"
    },
    "secure_totals": {
      "type": "boolean"
    }
  }
}
